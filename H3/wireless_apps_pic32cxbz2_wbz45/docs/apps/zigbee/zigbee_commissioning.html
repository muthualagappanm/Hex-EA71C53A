<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="http://10.12.80.161:4000/wireless/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="../../assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-16"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2724382-16'); </script> <script type="text/javascript" src="../../assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="../../assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Zigbee Commissioning Procedure | Microchip MPLAB Harmony Wireless help</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Zigbee Commissioning Procedure" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Harmony Wireless package" /> <meta property="og:description" content="Harmony Wireless package" /> <link rel="canonical" href="zigbee_commissioning.html" /> <meta property="og:url" content="http://10.12.80.161:4000/wireless/apps/zigbee/zigbee_commissioning.html" /> <meta property="og:site_name" content="Microchip MPLAB Harmony Wireless help" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Zigbee Commissioning Procedure" /> <script type="application/ld+json"> {"@type":"WebPage","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://10.12.80.161:4000/wireless/assets/images/vendor/microchip_mplab_harmony_logo_150_transparent.png"}},"url":"http://10.12.80.161:4000/wireless/apps/zigbee/zigbee_commissioning.html","headline":"Zigbee Commissioning Procedure","description":"Harmony Wireless package","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="../../index.html" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="zigbee_commissioning.html#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="../../index.html" class="nav-list-link">Mplab Code Configurator Wireless Package</a></li><li class="nav-list-item active"><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../readme.html" class="nav-list-link">Examples applications</a><ul class="nav-list "><li class="nav-list-item "><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../ble/building_blocks/readme.html" class="nav-list-link">BLE Building Blocks</a><ul class="nav-list"><li class="nav-list-item "> <a href="../ble/building_blocks/peripheral/readme.html" class="nav-list-link">Peripheral Building Blocks</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/central/scan_ext_adv/readme.html" class="nav-list-link">BLE Extended Scan</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/central/readme.html" class="nav-list-link">Central Building Blocks</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/central/connection/readme.html" class="nav-list-link">BLE Connection(Central)</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/central/profiles_services/readme.html" class="nav-list-link">BLE Profiles and Services (Central)</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/central/profiles_services/trp_uart/readme.html" class="nav-list-link">Central Transparent UART</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/central/profiles_services/ml_trp_uart/readme.html" class="nav-list-link">Multi Transparent UART</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/chip_peripherals/uart/readme.html" class="nav-list-link">UART Demo</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/central/freertos_ble_stack_init_central.html" class="nav-list-link">Freetos Stack Init</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/peripheral/legacy_adv_sleep/readme.html" class="nav-list-link">Legacy Advertisement</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/central/legacy_scan/readme.html" class="nav-list-link">Legacy Scan</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/peripheral/connection/readme.html" class="nav-list-link">Peripheral Connection</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/peripheral/ext_adv/readme.html" class="nav-list-link">Extended Advertisement</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/peripheral/profiles_services/readme.html" class="nav-list-link">Profile and Services</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/peripheral/profiles_services/custom_service/readme.html" class="nav-list-link">Custom Service</a> </li><li class="nav-list-item "> <a href="../ble/building_blocks/peripheral/profiles_services/trp_uart/readme.html" class="nav-list-link">Proprietary UART Service</a> </li></ul></li><li class="nav-list-item "><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../ble/advanced_applications/readme.html" class="nav-list-link">BLE Advance Applications</a><ul class="nav-list"><li class="nav-list-item "> <a href="../ble/advanced_applications/ble_uart_demo/readme.html" class="nav-list-link">BLE UART Demo</a> </li><li class="nav-list-item "> <a href="../ble/advanced_applications/ble_sensor_app/readme.html" class="nav-list-link">BLE Sensor DEMO</a> </li><li class="nav-list-item "> <a href="../ble/advanced_applications/ble_sensor_app/protocol.html" class="nav-list-link">BLE Sensor (Protocol Exchange)</a> </li></ul></li><li class="nav-list-item active"><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="readme.html" class="nav-list-link">Zigbee</a><ul class="nav-list"><li class="nav-list-item "> <a href="low_power_configuration.html" class="nav-list-link">Zigbee Low Power Config</a> </li><li class="nav-list-item active"> <a href="zigbee_commissioning.html" class="nav-list-link active">Zigbee Commissioning Procedure</a> </li><li class="nav-list-item "> <a href="zigbee_greenpower.html" class="nav-list-link">Zigbee Green Power</a> </li><li class="nav-list-item "> <a href="zigbee_project_generation.html" class="nav-list-link">Zigbee Application Project Generation</a> </li><li class="nav-list-item "> <a href="zigbee_security_model.html" class="nav-list-link">Zigbee Network Security Models</a> </li><li class="nav-list-item "> <a href="zigbee_combined_interface/readme.html" class="nav-list-link">Zigbee Combined Interface</a> </li><li class="nav-list-item "> <a href="zigbee_lights/readme.html" class="nav-list-link">Zigbee Light</a> </li><li class="nav-list-item "> <a href="zigbee_lights/readme_distributed.html" class="nav-list-link">Zigbee light Distributed Network</a> </li><li class="nav-list-item "> <a href="zigbee_multisensor/readme.html" class="nav-list-link">Zigbee multisensor</a> </li></ul></li><li class="nav-list-item "><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../multiprotocol/readme.html" class="nav-list-link">Multiprotocol</a><ul class="nav-list"><li class="nav-list-item "> <a href="../multiprotocol/ble_zigbee_basic/readme.html" class="nav-list-link">BLE+ZIGBEE Application</a> </li><li class="nav-list-item "> <a href="../multiprotocol/ble_zigbee_light_prov/readme.html" class="nav-list-link">Multiprotocol Demo App</a> </li><li class="nav-list-item "> <a href="../multiprotocol/ble_zigbee_light_prov/protocol.html" class="nav-list-link">Multiprotocol Demo</a> </li><li class="nav-list-item "> <a href="../multiprotocol/ble_zigbee_multiSensor_prov/readme.html" class="nav-list-link">Zigbee Multi-Sensor, commissioning App</a> </li></ul></li><li class="nav-list-item "><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../docs/readme.html" class="nav-list-link">User Docs</a><ul class="nav-list"><li class="nav-list-item "> <a href="consoleCommands.html" class="nav-list-link">Serial Console Commands</a> </li><li class="nav-list-item "> <a href="../docs/lowpower.html" class="nav-list-link">Low Power</a> </li><li class="nav-list-item "> <a href="../docs/user_action.html" class="nav-list-link">User Action</a> </li><li class="nav-list-item "> <a href="../docs/generate_code.html" class="nav-list-link">MCC Code Generation</a> </li><li class="nav-list-item "> <a href="../docs/creating_new_mplabx_harmony_project.html" class="nav-list-link">Generating New MCC Harmony Code</a> </li><li class="nav-list-item "> <a href="../docs/pic32cx_bz2_wbz45x_sdk_setup.html" class="nav-list-link">SDK Setup</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../release_notes.html" class="nav-list-link">Release notes</a><ul class="nav-list "><li class="nav-list-item "><a href="../ble/advanced_applications/ble_uart_demo/release_notes.html" class="nav-list-link">BLE UART Demo</a></li><li class="nav-list-item "><a href="../ble/advanced_applications/ble_sensor_app/release_notes.html" class="nav-list-link">BLE Sensor</a></li><li class="nav-list-item "><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../ble/building_blocks/peripheral/profiles_services/trp_uart/release_notes.html" class="nav-list-link">BLE Tranparent UART (Peirpheral)</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../ble/building_blocks/chip_peripherals/uart/release_notes.html" class="nav-list-link">UART Hello World</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../ble/building_blocks/peripheral/legacy_adv_sleep/release_notes.html" class="nav-list-link">BLE Legacy Adv</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../ble/building_blocks/peripheral/ext_adv/release_notes.html" class="nav-list-link">BLE Extended Advertising</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../ble/building_blocks/peripheral/connection/release_notes.html" class="nav-list-link">BLE Connection (Peripheral)</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../ble/building_blocks/peripheral/profiles_services/custom_service/release_notes.html" class="nav-list-link">BLE Tranparent UART (Peirpheral)</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../ble/building_blocks/central/connection/release_notes.html" class="nav-list-link">BLE Connection (Central)</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../ble/building_blocks/central/legacy_scan/release_notes.html" class="nav-list-link">BLE Legacy Scan</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../ble/building_blocks/central/profiles_services/ml_trp_uart/release_notes.html" class="nav-list-link">BLE Multilink Transparent UART(Central)</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="zigbee_commissioning.html#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../ble/building_blocks/central/profiles_services/trp_uart/release_notes.html" class="nav-list-link">BLE Transparent UART(Central)</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="../ble/building_blocks/central/scan_ext_adv/release_notes.html" class="nav-list-link">BLE Scan Extended Advertising</a></li><li class="nav-list-item "><a href="../multiprotocol/ble_zigbee_light_prov/release_notes.html" class="nav-list-link">Zigbee Multiprotocol Lights Prov App</a></li><li class="nav-list-item "><a href="../multiprotocol/ble_zigbee_multiSensor_prov/release_notes.html" class="nav-list-link">Zigbee Multi-Sensor and commissioning</a></li><li class="nav-list-item "><a href="zigbee_lights/release_notes.html" class="nav-list-link">Zigbee Combined Interface App</a></li><li class="nav-list-item "><a href="zigbee_combined_interface/release_notes.html" class="nav-list-link">Zigbee Combined Interface App</a></li><li class="nav-list-item "><a href="zigbee_multisensor/release_notes.html" class="nav-list-link">Zigbee Multi-Sensor</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Microchip MPLAB Harmony Wireless help" aria-label="Search Microchip MPLAB Harmony Wireless help" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://support.microchip.com" class="site-button" > Obtain Support from Microchip </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="../readme.html">Examples applications</a></li> <li class="breadcrumb-nav-list-item"><a href="readme.html">Zigbee</a></li> <li class="breadcrumb-nav-list-item"><span>Zigbee Commissioning Procedure</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <p><a href="https://www.microchip.com"><img src="https://www.microchip.com/ResourcePackages/Microchip/assets/dist/images/logo.png" alt="MCHP" /></a></p> <h1 id="zigbee-commissioning-procedure"> <a href="zigbee_commissioning.html#zigbee-commissioning-procedure" aria-labelledby="zigbee-commissioning-procedure" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Zigbee Commissioning Procedure </h1> <hr /> <p>Commissioning is the process of initializing the devices to join a network and to work together. The Zigbee Base Device Behaviour specification specifies the procedures for the following commissioning mechanisms which are executed in the order as given given below :</p> <p><a href="https://zigbeealliance.org/developer_resources/zigbee-base-device-behavior-bdb-v1-0/" target="_top">Link to Base Device Behaviour Specification by Zigbee Alliance</a></p> <div class="table-wrapper"><table> <thead> <tr> <th>Sequence</th> <th>Commissioning Aspect</th> <th>Details</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>Touchlink</td> <td>&lt;p&gt; A node may support the proximity based commissioning mechanism. If touchlink commissioning is supported, the node shall support touchlink as an initiator, a target or both.&lt;/p&gt; &lt;p&gt; <b>- Initiator </b>–&gt; Will be a member of an existing network or (if not) will create a new network&lt;/p&gt; &lt;p&gt; <b> - Target </b>–&gt; Gets added to network by Initiator&lt;/p&gt;</td> </tr> <tr> <td>2</td> <td>Network Steering</td> <td>&lt;p&gt;All nodes shall support network steering.&lt;/p&gt; &lt;p&gt; <b>- Node not on a network</b> -&gt; Action of searching for and joining an open network. &lt;/p&gt; &lt;p&gt; <b> - Node on a network</b> -&gt; It is the action of opening the network to allow new nodes to join &lt;/p&gt;</td> </tr> <tr> <td>3</td> <td>Network Formation</td> <td>&lt;p&gt;The ability of a node to form a network with its network security model. It shall be dependent on the logical device type of the node.&lt;/p&gt; &lt;p&gt; <b>- Zigbee coordinator </b> –&gt; Forms a Centralized security networks&lt;/p&gt; &lt;p&gt; <b>- Zigbee router </b> –&gt; Forms a Distributed security network</td> </tr> <tr> <td>4</td> <td>Finding &amp; Binding</td> <td>&lt;p&gt; <b> Initiator Endpoint </b> -&gt; Automatically searches and establishes application connections with target endpoint, by using the identify cluster with matching cluster &lt;/p&gt; &lt;p&gt;- <b> Target Endpoint </b> -&gt; Handles finding and binding requests from initiator endpoint &lt;/p&gt;</td> </tr> </tbody> </table></div> <p>Here, Touchlink, Steering and Formation decides zigbee network joining procedure. Finding &amp; binding is not related to joining procedure, but involves application level connections for cluster data transaction, to be done in any joining procedure.</p> <p>Default Mapping of Commissioning to zigbee device types :</p> <div style="text-align:center"><img src="doc/resources/CommisioningMappingDevice.png" /></div> <p>This is configurable from MPLAB Code Configurator (MCC) while generating the project:</p> <div style="text-align:center"><img src="doc/resources/comm_mcc.png" /></div> <p>The commissioning procedure can be automatically started when the device is first powered on, based on the 4 Commissioning Aspects (Touchlink, steering, formation, finding &amp; binding) chosen in above MPLAB Code Configurator (MCC). This is referred as auto commissioning.</p> <p>The application can also choose invoking this commisioning procedure manually through user input. In Microchip zigbee reference applications this is demonstrated through sending console commands through UART. This way of commissioning is referred as manual commissioning.</p> <h2 id="1-auto-commissioning"> <a href="zigbee_commissioning.html#1-auto-commissioning" aria-labelledby="1-auto-commissioning" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Auto Commissioning </h2> <p>Auto-commissioning/commissioning on startup is the easiest way of commissioning, which involves automatic commissioning of devices. It allows for minimal (or no) human intervention, since most of the startup parameters are pre-configured .The flowchart for the commissioning mode based on 4 commissioning aspect flags in Zigbee Application is described below :</p> <div style="text-align:center"><img src="doc/resources/FlowchartForCommissioningProcedure.png" /></div> <p>This type of commissioning can be enabled by user, using the MPLAB Code Configurator (MCC) as shown below :</p> <div style="text-align:center"><img src="doc/resources/auto.png" /></div> <p>Below is the example of auto commissioning procedure between Combined Interface and Thermostat applications.</p> <ol> <li>After Combined Interface application is programmed on the device, automatically device starts the commissioning procedure and creates the network.</li> </ol> <p><strong>Note:</strong> <i>“resetToFN” console command is used to bring the device to factory default state and reset the device. This step is needed only if the UART terminal is not setup before the device gets power on first and if logs are missed in terminal.</i></p> <ol> <li>Program another device with Thermostat application.</li> <li>After that the device joins , the joiner(Thermostat) starts reporting attribute data back to the Combined Interface device. Here there is no user input needed to initiate the commissioning. It can be observed below in the console logs :</li> </ol> <div style="text-align:center"><img src="doc/resources/auto_commissioning_ci_thermostat.jpg" /></div> <h2 id="2-manual-commissioning--when-uart-is-enabled"> <a href="zigbee_commissioning.html#2-manual-commissioning--when-uart-is-enabled" aria-labelledby="2-manual-commissioning--when-uart-is-enabled" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Manual Commissioning ( when uart is enabled) </h2> <p>Manual mode of commissioning is configured using the following MPLAB Code Configurator (MCC) :</p> <div style="text-align:center"><img src="doc/resources/man_com.png" /></div> <p>To trigger the commissioning procedures manually, the user has to issue the following console commands as given below:</p> <p><b>1. Touchlink</b> – “invokeCommissioning 1 0” (The device starts touchlink as an initiator) &lt;/p&gt;</p> <p><b>2. Network Steering</b> – “invokeCommissioning 2 0” (the device start to search for a network to join. If device is already part of the network, it will open the network for other devices to join) &lt;/p&gt;</p> <p><b>3. Network Formation</b> – “invokeCommissioning 4 0” (the device if it is a router or a coordinator, forms the network) &lt;/p&gt;</p> <p><b>4. Finding &amp; Binding</b> - “invokeCommissioning 8 0” (this command shall be given for any the devices which needs to be bound for clusters) - SetFBRole 1 (this command to be given on application endpoint acts as initiator which initiates the binding procedure by sending identify query request) - SetFBRole 0 (this command to be given on application endpoint acts as target)</p> <p><strong>Note:</strong> <i> Permit Join flag is enabled for 180 secs after forming a network and opens up the network for a finite duration to allow other nodes to join. To allow the joining even after 180 secs, give “setPermitJoin 180” or “invokeCommissioning 2 0” command from the console. The above mentioned note holds good for both Commissioning on Startup (auto) and manual commissioning procedure </i></p> <p>The below table shows the list of manual commissioning command sequences to be followed between 2 joining devices.</p> <div class="table-wrapper"><table> <thead> <tr> <th>S.No.</th> <th>Coordinator</th> <th>Router/End device</th> <th>Commands</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>Combined interface</td> <td>Thermostat</td> <td>&lt;p&gt;1. Combined Interface and Thermostat - resetToFN&lt;/p&gt; &lt;p&gt;2.Combined Interface - invokeCommissioning 4 0&lt;/p&gt; &lt;p&gt;3. Combined Interface - invokeCommissioning 2 0&lt;/p&gt; &lt;p&gt;4. Thermostat - invokeCommissioning 2 0 (After this Thermostat joins Combined Interface)&lt;/p&gt; &lt;p&gt; 5. Combined Interface - SetFBRole 0&lt;/p&gt; &lt;p&gt; 6. Thermostat - SetFBRole 1 &lt;p&gt;7. Combined Interface - invokeCommissioning 8 0&lt;/p&gt; &lt;p&gt;8. Thermostat - invokeCommissioning 8 0&lt;/p&gt; &lt;p&gt;9. Thermostat Device will start reporting periodically. &lt;/p&gt;</td> </tr> <tr> <td>2</td> <td>Combined interface</td> <td>Multi Sensor</td> <td>&lt;p&gt;1. Combined Interface and Multi Sensor - resetToFN&lt;/p&gt; &lt;p&gt;2. Combined Interface - invokeCommissioning 4 0 &lt;/p&gt; &lt;p&gt;3. Combined Interface - invokeCommissioning 2 0&lt;/p&gt; &lt;p&gt;4. Multi Sensor - invokeCommissioning 2 0 (After this Multi Sensor joins Combined Interface) &lt;/p&gt; &lt;p&gt;5. Combined Interface - SetFBRole 0&lt;/p&gt; &lt;p&gt;6. Combined Interface - invokeCommissioning 8 0&lt;/p&gt; &lt;p&gt;7. Multi Sensor - setSrcSensorType -ls &lt;/p&gt; &lt;p&gt;8. Multi Sensor - SetFBRole 1&lt;/p&gt; &lt;p&gt;9. Multi Sensor - invokeCommissioning 8 0 (After this Light Sensor Finding and Binding happens) &lt;/p&gt; &lt;p&gt;10. Multi Sensor - setSrcSensorType -os &lt;/p&gt; &lt;p&gt;11. Multi Sensor - SetFBRole 1&lt;/p&gt; &lt;p&gt;12. Multi Sensor - invokeCommissioning 8 0 (After this Illuminance Measurement Finding and Binding happens)&lt;/p&gt; &lt;p&gt;13. Multi Sensor - setSrcSensorType -ts&lt;/p&gt; &lt;p&gt;14. Multi Sensor - SetFBRole 1&lt;/p&gt; &lt;p&gt;15. Multi Sensor - invokeCommissioning 8 0 (After this Temperature Measurement Finding and Binding happens)&lt;/p&gt; &lt;p&gt;16. Multi Sensor - setSrcSensorType -hs &lt;/p&gt; &lt;p&gt;17. Multi Sensor - SetFBRole 1&lt;/p&gt; &lt;p&gt;18. Multi Sensor - invokeCommissioning 8 0 (After this Relative Humidity Measurement Finding and Binding happens)&lt;/p&gt; &lt;p&gt;19. Multi Sensor Device will start reporting periodically&lt;/p&gt;</td> </tr> <tr> <td>3</td> <td>Combined interface</td> <td>Lights</td> <td>&lt;p&gt;1. Combined Interface and Light - resetToFN&lt;/p&gt; &lt;p&gt;2. Combined Interface - invokeCommissioning 4 0 &lt;/p&gt; &lt;p&gt;3. Combined Interface - invokeCommissioning 2 0&lt;/p&gt; &lt;p&gt;4. Light - invokeCommissioning 2 0 (After this Light joins Combined Interface)&lt;/p&gt; &lt;p&gt; 5. Combined Interface - SetFBRole 0&lt;/p&gt; &lt;p&gt;6. Light - SetFBRole 1&lt;/p&gt; &lt;p&gt;7. Combined Interface - invokeCommissioning 8 0 &lt;/p&gt; &lt;p&gt;8. Light - invokeCommissioning 8 0 (After this all the Finding and Binding happens)&lt;/p&gt; &lt;p&gt;9. Light Device will start reporting peridically&lt;/p&gt;</td> </tr> </tbody> </table></div> <p><strong>Note:</strong> <i> invokeCommissioning 8 0 has to be executed first on target device then on initiator device. <strong>SetFBRole 0</strong> sets device as Target, <strong>SetFBRole 1</strong> sets the device as Initiator. A single device can act as initiator and/or target </i></p> <p><strong>Combined interface and Thermostat :</strong></p> <div style="text-align:center"><img src="doc/resources/manual_ci_thermostat.JPG" /></div> <p><strong>Combined interface and Multi-sensor :</strong></p> <div style="text-align:center"><img src="doc/resources/manual_ci_multi-sensor.JPG" /></div> <p><strong>Combined interface and Extended Lights :</strong></p> <div style="text-align:center"><img src="doc/resources/manual_ci_lights.JPG" /></div> <h2 id="3-touchlink-commissioning"> <a href="zigbee_commissioning.html#3-touchlink-commissioning" aria-labelledby="3-touchlink-commissioning" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. Touchlink Commissioning </h2> <p>The zigbee protocol provides special commissioning called Touchlink , which is an easy-to-use proximity mechanism for commisioning a device to a network. This method works by the Touchlink ‘initiator’ determining the proximity of the target device (to be commissioned) and negotiating/transferring network parameters. Touchlink commissioning can be used to form a new network and/or join a node to an existing network. Touchlink is initiated on a node called the ‘initiator’. Touchlink is provided as a cluster in the ZigBee Cluster Library (ZCL). The initiator must support the Touchlink cluster as a client and the target node must support the cluster as a server. If it is required on a node, Touchlink commissioning must be enabled via the ZigBee Base Device attribute bdbCommissioningMode.</p> <p><strong>Wireshark Sniffer logs</strong></p> <div style="text-align:center"><img src="doc/resources/wireshark_sniffer_logs_auto_touchlink_commissioning_lights_csc.JPG" /></div> <p>Let us look into an example. Here a ColorSceneController which is an end device type will bring the light into the network and by asking light to form the distributed network via Touchlink. For touchlink, a color scene controller shall be brought close to a target( Light) device around like 20-30cms range. It can be done in the following 2 ways :</p> <p><strong>(a). Auto-commissioning :</strong> In order to establish touchlink via auto-commissioning , each of the application e.g. extended lights and color scene controller, MPLAB Code Configuration (MCC) has to be updated as shown below :</p> <div style="text-align:center"><img src="doc/resources/auto_tl.png" /></div> <p>During auto commissioning mode , the device would perform touchlink by default. To initiate the process, input <i>“resetToFN”</i> console command on the light device first followed by the color scene controller. After that the device joins via touchlink, the Light device starts reporting attribute data back to the ColorSceneController device. It can be observed below in :</p> <p><strong>Console Logs</strong></p> <div style="text-align:center"><img src="doc/resources/auto_comm_tl.jpg" /></div> <p><strong>(b). Manual commisioning :</strong> In order to establish touchlink commissioning manually, each of the application e.g. extended lights and color scene controller, MPLAB Code Configurator (MCC) has to be updated as shown below :</p> <div style="text-align:center"><img src="doc/resources/manual_tl.png" /></div> <p>During manual commissioning mode , we need to issue console commands on the color scene controller device to perform touchlink. In order to initiate the process, input resetToFN console comand on the light device first followed by the color scene controller. Follow the below sequence of commands</p> <ol> <li>Light and CSC - resetToFN</li> <li>CSC - invokeCommissioning 1 0 (Touchlink commisioning, wait for touchlinking to be completed)</li> <li>CSC - SetFBRole 0</li> <li>Light - SetFBRole 1</li> <li>CSC - invokeCommissioning 8 0</li> <li>Light - invokeCommissioning 8 0</li> <li>Light Device will start reporting periodically.</li> </ol> <p><strong>Console Logs</strong></p> <div style="text-align:center"><img src="doc/resources/manual_touchlink_commisioning.JPG" /></div> <p>For more details regarding the commisioning procedures, please refer to, the Commisioning section(8) of the base device behaviour specification from Zigbee Alliance -&gt; <a href="https://zigbeealliance.org/developer_resources/zigbee-base-device-behavior-bdb-v1-0/" target="_top">Link to Base Device Behaviour Specification by Zigbee Alliance</a></p> <hr /> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0"><img src='https://raw.githubusercontent.com/wiki/Microchip-MPLAB-Harmony/Microchip-MPLAB-Harmony.github.io/images/microchip_logo.png' /><br />Copyright &copy; 2020 Microchip Technology.</p> <!-- <p class="text-small text-grey-dk-000 mb-0"><img src='http://10.12.80.161:4000/wireless/assets/images/vendor/microchip_logo.png' /><br /> Copyright &copy; 2022 Microchip Technology.</p> --> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
